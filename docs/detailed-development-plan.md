# ìƒìƒë ¥ì„ í¼ì¹˜ëŠ” ê¸€ì“°ê¸° ì•± - ìƒì„¸ ê°œë°œ ê³„íš

## ğŸ“‹ í˜„ì¬ ì•± êµ¬ì¡° ë¶„ì„

### ğŸ¯ **ê¸°ì¡´ ì•± vs ê³„íš ë¬¸ì„œ ë¹„êµ**

#### í˜„ì¬ ì•±ì˜ ì‹¤ì œ êµ¬ì¡°
```
í˜„ì¬ ì•±: "ì‹¤ì‹œê°„ ë‚±ë§/ë¬¸ì¥ ê³µìœ  í”Œë«í¼"
- êµì‚¬ê°€ Google ë¡œê·¸ì¸ìœ¼ë¡œ í´ë˜ìŠ¤ ìƒì„±
- í•™ìƒì´ ì°¸ì—¬ì½”ë“œë¡œ ìµëª… ì ‘ì†
- ì‹¤ì‹œê°„ ì´ë¯¸ì§€ ê³µìœ  â†’ ë‚±ë§ ì…ë ¥ â†’ ë¬¸ì¥ ì‘ì„±
- ì‹¤ì‹œê°„ í”¼ë“œ & ê³µê°(ì¢‹ì•„ìš”) ê¸°ëŠ¥
```

#### ê°œë°œ ê³„íš ë¬¸ì„œì˜ ëª©í‘œ
```
ê³„íš ë¬¸ì„œ: "ë‚±ë§ íƒí—˜ ë° AI íŠœí„° ì‹œìŠ¤í…œ"
- ë‚±ë§ ì‚¬ì „ ì—°ë™í•œ ì–´íœ˜ í™•ì¥ ê²Œì„
- AI í”¼ë“œë°± & ê°œì¸í™” í•™ìŠµ ê²½í—˜  
- í¬ì¸íŠ¸/ë ˆë²¨/ë°°ì§€ ê²Œì„í™” ì‹œìŠ¤í…œ
- ê°œë³„ í•™ìŠµ í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬
```

### ğŸ” **í•µì‹¬ ì°¨ì´ì  ë° ê°œë°œ ë°©í–¥**
| ì˜ì—­ | í˜„ì¬ ì•± | ê³„íš ë¬¸ì„œ | ê°œë°œ ì „ëµ |
|------|---------|-----------|-----------|
| **í•µì‹¬ ê°€ì¹˜** | ì‹¤ì‹œê°„ í˜‘ì—… ê¸€ì“°ê¸° | ê°œì¸í™” ì–´íœ˜ í•™ìŠµ | ë‘ ê°€ì¹˜ë¥¼ **í†µí•©** - í˜‘ì—…í•˜ë©° ê°œë³„ ì„±ì¥ |
| **í•™ìŠµ êµ¬ì¡°** | ë‹¨ìˆœ ì´ë¯¸ì§€â†’ë¬¸ì¥ | ë‚±ë§ íƒí—˜â†’í™•ì¥â†’ë¬¸ì¥ | í˜„ì¬ êµ¬ì¡°ì— **íƒí—˜ ë‹¨ê³„ ì‚½ì…** |
| **AI ì—­í• ** | ì˜ê° ì œê³µ ë„êµ¬ | ê°œì¸ íŠœí„° & í”¼ë“œë°± | AI ê¸°ëŠ¥ì„ **ì ì§„ì  í™•ì¥** |
| **ë°ì´í„°** | ì‹¤ì‹œê°„ ê³µìœ  ì¤‘ì‹¬ | ê°œì¸ í•™ìŠµ ê¸°ë¡ ì¤‘ì‹¬ | **ê°œì¸+ê³µìœ  ë°ì´í„° ë³‘í–‰** ê´€ë¦¬ |

---

## ğŸš€ ë‹¨ê³„ë³„ ì‚¬ìš©ì ì—¬ì • ë§¤í•‘

### ğŸ‘¨â€ğŸ« **êµì‚¬ ì‚¬ìš©ì ì—¬ì •**

#### Phase 1: ìˆ˜ì—… ì¤€ë¹„
```mermaid
graph TD
    A[Google ë¡œê·¸ì¸] --> B[ëŒ€ì‹œë³´ë“œ ì ‘ê·¼]
    B --> C[ìƒˆ í´ë˜ìŠ¤ ìƒì„±]
    C --> D[ì°¸ì—¬ ì½”ë“œ í™•ì¸]
    D --> E[í´ë˜ìŠ¤ ì…ì¥]
    E --> F[í™œë™ ì‹œì‘ ë²„íŠ¼]
    F --> G[ì´ë¯¸ì§€ ìƒì„±/ì—…ë¡œë“œ]
```

**í•„ìš”í•œ ê¸°ëŠ¥:**
- âœ… **ì´ë¯¸ êµ¬í˜„ë¨**: Google OAuth, í´ë˜ìŠ¤ CRUD, ì°¸ì—¬ì½”ë“œ ì‹œìŠ¤í…œ
- ğŸ”„ **ê°œì„  í•„ìš”**: í´ë˜ìŠ¤/í™œë™ ìˆ˜ì • ê¸°ëŠ¥, íˆìŠ¤í† ë¦¬ ê´€ë¦¬

#### Phase 2: ìˆ˜ì—… ì§„í–‰
```mermaid  
graph TD
    A[í™œë™ ì‹œì‘] --> B[ë‚±ë§ ìˆ˜ì§‘ ë‹¨ê³„ í™œì„±í™”]
    B --> C[ì‹¤ì‹œê°„ ë‚±ë§ ëª¨ë‹ˆí„°ë§]
    C --> D[ë¬¸ì¥ ì‘ì„± ë‹¨ê³„ í™œì„±í™”]
    D --> E[ì‹¤ì‹œê°„ ë¬¸ì¥ í”¼ë“œ í™•ì¸]
    E --> F[AI ì˜ê° ì œê³µ]
    F --> G[ê²°ê³¼ ë‚´ë³´ë‚´ê¸°]
```

**í•„ìš”í•œ ê¸°ëŠ¥:**
- âœ… **ì´ë¯¸ êµ¬í˜„ë¨**: ë‹¨ê³„ë³„ í™œë™ ì œì–´, ì‹¤ì‹œê°„ í”¼ë“œ, CSV/PDF ë‚´ë³´ë‚´ê¸°
- ğŸ†• **ì‹ ê·œ í•„ìš”**: ë‚±ë§ íƒí—˜ ì‹œìŠ¤í…œ, ê°œë³„ í•™ìƒ ì§„ë„ í™•ì¸

#### Phase 3: ìˆ˜ì—… í›„ ê´€ë¦¬
```mermaid
graph TD
    A[í™œë™ ì¢…ë£Œ] --> B[ê²°ê³¼ ë¶„ì„]
    B --> C[í•™ìƒë³„ ì„±ì¥ í™•ì¸]
    C --> D[ë‹¤ìŒ ìˆ˜ì—… ê³„íš]
    D --> E[í…œí”Œë¦¿ ì €ì¥]
```

**í•„ìš”í•œ ê¸°ëŠ¥:**
- ğŸ†• **ì‹ ê·œ í•„ìš”**: í•™ìŠµ ë¶„ì„ ëŒ€ì‹œë³´ë“œ, í¬íŠ¸í´ë¦¬ì˜¤ ì‹œìŠ¤í…œ, í™œë™ í…œí”Œë¦¿

### ğŸ‘§ğŸ‘¦ **í•™ìƒ ì‚¬ìš©ì ì—¬ì •**

#### Phase 1: ìˆ˜ì—… ì°¸ì—¬
```mermaid
graph TD
    A[ì°¸ì—¬ì½”ë“œ ì…ë ¥] --> B[ìµëª… ë¡œê·¸ì¸]
    B --> C[í™œë™ í™”ë©´ ì ‘ê·¼] 
    C --> D[ì´ë¯¸ì§€ í™•ì¸]
```

**í•„ìš”í•œ ê¸°ëŠ¥:**
- âœ… **ì´ë¯¸ êµ¬í˜„ë¨**: ì°¸ì—¬ì½”ë“œ ì‹œìŠ¤í…œ, ìµëª… ì¸ì¦, ì‹¤ì‹œê°„ ë™ê¸°í™”
- ğŸ†• **ì‹ ê·œ í•„ìš”**: í•™ìƒ êµ¬ê¸€ ë¡œê·¸ì¸ ê¸°ëŠ¥

#### Phase 2: ë‚±ë§ íƒí—˜ (ì‹ ê·œ)
```mermaid
graph TD
    A[ì´ë¯¸ì§€ ë³´ê¸°] --> B[í•µì‹¬ ë‚±ë§ ì…ë ¥]
    B --> C[ë‚±ë§ íƒí—˜ ë²„íŠ¼ í´ë¦­]
    C --> D[ì—°ê´€ì–´ ì¹´í…Œê³ ë¦¬ íƒìƒ‰]
    D --> E[ê´€ì‹¬ ë‚±ë§ ìˆ˜ì§‘]
    E --> F[ê°œì¸ ë°œê²¬ ë‚±ë§ ì¶”ê°€]
    F --> G[AI ê²©ë ¤ í”¼ë“œë°±]
```

**í•„ìš”í•œ ê¸°ëŠ¥:**
- ğŸ†• **ì‹ ê·œ ê°œë°œ**: ë‚±ë§ íƒí—˜ ëª¨ë‹¬, ì‚¬ì „ API ì—°ë™, ê°œì¸ ê¾¸ëŸ¬ë¯¸, AI í”¼ë“œë°±

#### Phase 3: ë¬¸ì¥ ì°½ì‘ & ê³µìœ 
```mermaid
graph TD
    A[ìˆ˜ì§‘í•œ ë‚±ë§ í™œìš©] --> B[ë¬¸ì¥ ì‘ì„±]
    B --> C[ë¬¸ì¥ ì œì¶œ]
    C --> D[ì‹¤ì‹œê°„ í”¼ë“œì— ê³µê°œ]
    D --> E[ë‹¤ë¥¸ í•™ìƒ ì‘í’ˆ ê°ìƒ]
    E --> F[ê³µê° í‘œí˜„]
    F --> G[í¬ì¸íŠ¸ íšë“]
```

**í•„ìš”í•œ ê¸°ëŠ¥:**
- âœ… **ì´ë¯¸ êµ¬í˜„ë¨**: ë¬¸ì¥ ì‘ì„±/ì œì¶œ, ì‹¤ì‹œê°„ í”¼ë“œ, ì¢‹ì•„ìš” ì‹œìŠ¤í…œ
- ğŸ†• **ì‹ ê·œ í•„ìš”**: í¬ì¸íŠ¸/ë ˆë²¨ ì‹œìŠ¤í…œ, ê°œì¸ ì„±ì¥ ê¸°ë¡

---

## ğŸ¯ ìš°ì„ ìˆœìœ„ë³„ ê°œë°œ ê³„íš

### ğŸ”¥ **1ë‹¨ê³„: í•µì‹¬ í¸ì˜ ê¸°ëŠ¥ ì™„ì„± (2-3ì£¼)**

#### ëª©í‘œ: í˜„ì¬ ì‹œìŠ¤í…œì˜ ì‚¬ìš©ì„± ê°œì„  ë° ì•ˆì •ì„± í™•ë³´

#### ì¶”ê°€ ê°œì„  ì‚¬í•­: Google ë¡œê·¸ì¸ ë° QR ì½”ë“œ ê¸°ëŠ¥ í†µí•©

##### 1.0 Google ë¡œê·¸ì¸ í†µí•© (1ì£¼ì°¨ ì´ˆ)
**ì˜ˆìƒ ê³µìˆ˜: 8ì‹œê°„**

**í•™ìƒìš© Google ë¡œê·¸ì¸ ì¶”ê°€:**
```javascript
// ê¸°ì¡´ ìµëª… ë¡œê·¸ì¸ ìœ ì§€í•˜ë©´ì„œ Google ë¡œê·¸ì¸ ì˜µì…˜ ì¶”ê°€
// student.html ë˜ëŠ” join-class.html
const initGoogleAuth = () => {
    gapi.load('auth2', () => {
        gapi.auth2.init({
            client_id: 'YOUR_GOOGLE_CLIENT_ID'
        }).then(() => {
            const authInstance = gapi.auth2.getAuthInstance();
            
            // Google ë¡œê·¸ì¸ ë²„íŠ¼ ì´ë²¤íŠ¸
            document.getElementById('google-login-btn').addEventListener('click', () => {
                authInstance.signIn().then((user) => {
                    const profile = user.getBasicProfile();
                    const studentData = {
                        name: profile.getName(),
                        email: profile.getEmail(),
                        googleId: profile.getId(),
                        avatar: profile.getImageUrl(),
                        loginType: 'google',
                        joinedAt: new Date()
                    };
                    
                    joinClassWithGoogleAuth(studentData);
                });
            });
        });
    });
};

const joinClassWithGoogleAuth = async (studentData) => {
    try {
        // í´ë˜ìŠ¤ ì°¸ì—¬ ì½”ë“œ í™•ì¸
        const joinCode = document.getElementById('join-code').value;
        
        // Firestoreì— í•™ìƒ ì •ë³´ ì €ì¥ (ê°œì¸ ì‹ë³„ ê°€ëŠ¥)
        const result = await firebase.functions().httpsCallable('joinClassWithGoogle')({
            joinCode: joinCode,
            studentData: studentData
        });
        
        if (result.data.success) {
            // í´ë˜ìŠ¤ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜
            window.location.href = `student.html?classId=${result.data.classId}&studentId=${result.data.studentId}`;
        }
    } catch (error) {
        console.error('Google login failed:', error);
        alert('ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
    }
};
```

**UI ê°œì„ :**
```html
<!-- í•™ìƒ ë¡œê·¸ì¸ ì˜µì…˜ ì¶”ê°€ -->
<div class="login-options">
    <h3>í´ë˜ìŠ¤ ì°¸ì—¬ ë°©ë²• ì„ íƒ</h3>
    
    <div class="login-method">
        <button id="anonymous-login-btn" class="btn btn-primary">
            ğŸ‘¤ ìµëª…ìœ¼ë¡œ ì°¸ì—¬í•˜ê¸°
            <small>ì´ë¦„ë§Œ ì…ë ¥í•˜ê³  ë¹ ë¥´ê²Œ ì°¸ì—¬</small>
        </button>
    </div>
    
    <div class="login-divider">
        <span>ë˜ëŠ”</span>
    </div>
    
    <div class="login-method">
        <button id="google-login-btn" class="btn btn-google">
            <img src="/images/google-logo.png" alt="Google"> 
            Googleë¡œ ì°¸ì—¬í•˜ê¸°
            <small>ë‚´ ì‘í’ˆì„ ê°œì¸ í¬íŠ¸í´ë¦¬ì˜¤ì— ì €ì¥</small>
        </button>
    </div>
</div>
```

##### 1.1 QR ì½”ë“œ í´ë˜ìŠ¤ ì°¸ì—¬ ì‹œìŠ¤í…œ (1ì£¼ì°¨ ì¤‘)
**ì˜ˆìƒ ê³µìˆ˜: 10ì‹œê°„**

**QR ì½”ë“œ ìƒì„± (êµì‚¬ìš©):**
```javascript
// dashboard.js - í´ë˜ìŠ¤ QR ì½”ë“œ ìƒì„±
const generateClassQR = async (classId, joinCode) => {
    const classUrl = `${window.location.origin}/join-class.html?code=${joinCode}`;
    
    // QR ì½”ë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© (qrcode.js)
    const qrCodeDataURL = await QRCode.toDataURL(classUrl, {
        width: 256,
        margin: 2,
        color: {
            dark: '#000000',
            light: '#FFFFFF'
        }
    });
    
    return qrCodeDataURL;
};

// QR ì½”ë“œ ëª¨ë‹¬ í‘œì‹œ
const showQRModal = async (classData) => {
    const qrCodeImage = await generateClassQR(classData.id, classData.joinCode);
    
    const modal = document.getElementById('qr-modal');
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ“± QR ì½”ë“œë¡œ í´ë˜ìŠ¤ ì°¸ì—¬</h2>
                <button class="close-modal">âœ•</button>
            </div>
            
            <div class="modal-body">
                <div class="qr-container">
                    <img src="${qrCodeImage}" alt="QR Code" class="qr-code">
                    <p class="class-info">
                        <strong>${classData.className}</strong><br>
                        ì°¸ì—¬ ì½”ë“œ: <span class="join-code">${classData.joinCode}</span>
                    </p>
                </div>
                
                <div class="qr-instructions">
                    <h4>ğŸ“‹ ì°¸ì—¬ ë°©ë²•</h4>
                    <ol>
                        <li>í•™ìƒë“¤ì´ ìŠ¤ë§ˆíŠ¸í° ì¹´ë©”ë¼ë¡œ QR ì½”ë“œë¥¼ ìŠ¤ìº”í•©ë‹ˆë‹¤</li>
                        <li>ìë™ìœ¼ë¡œ ì°¸ì—¬ í˜ì´ì§€ê°€ ì—´ë¦½ë‹ˆë‹¤</li>
                        <li>ì´ë¦„ì„ ì…ë ¥í•˜ê³  "ì°¸ì—¬í•˜ê¸°" ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤</li>
                    </ol>
                </div>
                
                <div class="qr-actions">
                    <button id="download-qr" class="btn btn-primary">
                        ğŸ’¾ QR ì½”ë“œ ë‹¤ìš´ë¡œë“œ
                    </button>
                    <button id="print-qr" class="btn btn-secondary">
                        ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°
                    </button>
                </div>
            </div>
        </div>
    `;
    
    modal.style.display = 'block';
    
    // QR ì½”ë“œ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥
    document.getElementById('download-qr').addEventListener('click', () => {
        const link = document.createElement('a');
        link.download = `${classData.className}_QRì½”ë“œ.png`;
        link.href = qrCodeImage;
        link.click();
    });
    
    // ì¸ì‡„ ê¸°ëŠ¥
    document.getElementById('print-qr').addEventListener('click', () => {
        const printWindow = window.open('', '_blank');
        printWindow.document.write(`
            <html>
                <head><title>${classData.className} QR ì½”ë“œ</title></head>
                <body style="text-align: center; font-family: Arial;">
                    <h2>${classData.className}</h2>
                    <img src="${qrCodeImage}" style="width: 300px; height: 300px;">
                    <p>ì°¸ì—¬ ì½”ë“œ: ${classData.joinCode}</p>
                </body>
            </html>
        `);
        printWindow.print();
    });
};
```

**í•™ìƒìš© QR ìŠ¤ìº” ìë™ ì°¸ì—¬:**
```javascript
// join-class.html - URL íŒŒë¼ë¯¸í„°ì—ì„œ ì°¸ì—¬ ì½”ë“œ ìë™ ì¶”ì¶œ
const autoFillJoinCode = () => {
    const urlParams = new URLSearchParams(window.location.search);
    const joinCode = urlParams.get('code');
    
    if (joinCode) {
        document.getElementById('join-code').value = joinCode;
        // ì¶”ê°€ì ìœ¼ë¡œ í´ë˜ìŠ¤ ì •ë³´ ë¯¸ë¦¬ ë¡œë“œ
        preloadClassInfo(joinCode);
    }
};

const preloadClassInfo = async (joinCode) => {
    try {
        const classInfo = await firebase.functions().httpsCallable('getClassByJoinCode')({
            joinCode: joinCode
        });
        
        if (classInfo.data.success) {
            // í´ë˜ìŠ¤ ì •ë³´ ë¯¸ë¦¬ í‘œì‹œ
            document.getElementById('class-preview').innerHTML = `
                <div class="class-preview-card">
                    <h3>ğŸ¯ ì°¸ì—¬í•  í´ë˜ìŠ¤</h3>
                    <div class="class-details">
                        <strong>${classInfo.data.className}</strong>
                        <p>êµì‚¬: ${classInfo.data.teacherName}</p>
                        <p>í˜„ì¬ ì°¸ì—¬ì: ${classInfo.data.currentStudents}ëª…</p>
                    </div>
                </div>
            `;
        }
    } catch (error) {
        console.error('Failed to load class info:', error);
    }
};

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
document.addEventListener('DOMContentLoaded', autoFillJoinCode);
```

##### 1.2 êµì‚¬ë³„ Gemini API í‚¤ ê´€ë¦¬ ì‹œìŠ¤í…œ (1ì£¼ì°¨ ë§)
**ì˜ˆìƒ ê³µìˆ˜: 12ì‹œê°„**

**API í‚¤ ê´€ë¦¬ UI:**
```html
<!-- dashboard.htmlì— ì„¤ì • ì„¹ì…˜ ì¶”ê°€ -->
<div class="settings-section">
    <h3>âš™ï¸ AI ì„¤ì • ê´€ë¦¬</h3>
    
    <div class="api-key-management">
        <div class="current-api-status">
            <h4>í˜„ì¬ AI ìƒíƒœ</h4>
            <div id="ai-status-indicator" class="status-indicator">
                <!-- ìƒíƒœê°€ ë™ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¨ -->
            </div>
        </div>
        
        <div class="api-key-form">
            <h4>ğŸ”‘ Gemini API í‚¤ ì„¤ì •</h4>
            <div class="form-group">
                <label for="gemini-api-key">API í‚¤:</label>
                <div class="input-group">
                    <input type="password" id="gemini-api-key" 
                           placeholder="AIzaSy... (Google AI Studioì—ì„œ ë°œê¸‰ë°›ì€ í‚¤)" 
                           class="api-key-input">
                    <button type="button" id="toggle-api-visibility" class="btn-icon">ğŸ‘ï¸</button>
                </div>
                <small class="help-text">
                    ğŸ“‹ <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a>ì—ì„œ ë¬´ë£Œë¡œ API í‚¤ë¥¼ ë°œê¸‰ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </small>
            </div>
            
            <div class="form-actions">
                <button id="test-api-key" class="btn btn-secondary">ğŸ§ª ì—°ê²° í…ŒìŠ¤íŠ¸</button>
                <button id="save-api-key" class="btn btn-primary">ğŸ’¾ ì €ì¥í•˜ê¸°</button>
                <button id="remove-api-key" class="btn btn-danger">ğŸ—‘ï¸ ì‚­ì œ</button>
            </div>
        </div>
        
        <div class="api-usage-info">
            <h4>ğŸ“Š ì´ë²ˆ ë‹¬ ì‚¬ìš©ëŸ‰</h4>
            <div class="usage-stats">
                <div class="usage-item">
                    <span>í”¼ë“œë°± ìƒì„±:</span>
                    <span id="feedback-count">0íšŒ</span>
                </div>
                <div class="usage-item">
                    <span>ì˜ˆìƒ ë¹„ìš©:</span>
                    <span id="estimated-cost">$0.00</span>
                </div>
            </div>
        </div>
    </div>
</div>
```

**ë°±ì—”ë“œ API í‚¤ ê´€ë¦¬:**
```javascript
// Cloud Function - API í‚¤ ì•”í˜¸í™” ì €ì¥
exports.saveTeacherAPIKey = functions.https.onCall(async (data, context) => {
    // ì¸ì¦ í™•ì¸
    if (!context.auth || !context.auth.uid) {
        throw new functions.https.HttpsError('unauthenticated', 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
    }
    
    const { apiKey } = data;
    const teacherId = context.auth.uid;
    
    // API í‚¤ ìœ íš¨ì„± ê²€ì¦
    const isValidKey = await validateGeminiAPIKey(apiKey);
    if (!isValidKey) {
        throw new functions.https.HttpsError('invalid-argument', 'ìœ íš¨í•˜ì§€ ì•Šì€ API í‚¤ì…ë‹ˆë‹¤.');
    }
    
    // ì•”í˜¸í™”í•˜ì—¬ ì €ì¥ (crypto ì‚¬ìš©)
    const crypto = require('crypto');
    const algorithm = 'aes-256-gcm';
    const secretKey = functions.config().encryption.key; // Firebase í™˜ê²½ë³€ìˆ˜
    
    const iv = crypto.randomBytes(16);
    const cipher = crypto.createCipher(algorithm, secretKey);
    const encrypted = cipher.update(apiKey, 'utf8', 'hex') + cipher.final('hex');
    const authTag = cipher.getAuthTag();
    
    // Firestoreì— ì•”í˜¸í™”ëœ í‚¤ ì €ì¥
    await admin.firestore().doc(`teachers/${teacherId}`).set({
        encryptedAPIKey: encrypted,
        keyIV: iv.toString('hex'),
        authTag: authTag.toString('hex'),
        keyLastUpdated: admin.firestore.FieldValue.serverTimestamp(),
        apiUsage: {
            monthlyFeedbackCount: 0,
            lastResetDate: admin.firestore.FieldValue.serverTimestamp()
        }
    }, { merge: true });
    
    return { success: true, message: 'API í‚¤ê°€ ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.' };
});

// API í‚¤ ë³µí˜¸í™” ë° ì‚¬ìš©
const getDecryptedAPIKey = async (teacherId) => {
    const teacherDoc = await admin.firestore().doc(`teachers/${teacherId}`).get();
    
    if (!teacherDoc.exists || !teacherDoc.data().encryptedAPIKey) {
        throw new Error('API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
    }
    
    const data = teacherDoc.data();
    const decipher = crypto.createDecipher('aes-256-gcm', functions.config().encryption.key);
    decipher.setAuthTag(Buffer.from(data.authTag, 'hex'));
    
    const decrypted = decipher.update(data.encryptedAPIKey, 'hex', 'utf8') + decipher.final('utf8');
    return decrypted;
};

// ìˆ˜ì •ëœ AI í”¼ë“œë°± ìƒì„± í•¨ìˆ˜
exports.generateAIFeedbackWithPersonalKey = functions.https.onCall(async (data, context) => {
    const { classId, activityId } = data;
    const teacherId = context.auth.uid;
    
    try {
        // êµì‚¬ì˜ ê°œì¸ API í‚¤ ê°€ì ¸ì˜¤ê¸°
        const apiKey = await getDecryptedAPIKey(teacherId);
        
        // Gemini API ì„¤ì •
        const { GoogleGenerativeAI } = require('@google/generative-ai');
        const genAI = new GoogleGenerativeAI(apiKey);
        const model = genAI.getGenerativeModel({ model: 'gemini-pro' });
        
        // í•™ìƒ ë¬¸ì¥ë“¤ ìˆ˜ì§‘
        const sentences = await getSentencesForActivity(classId, activityId);
        
        const prompt = `
            ë‹¤ìŒì€ ì´ˆë“±í•™ìƒë“¤ì´ ì°½ì‘í•œ ë¬¸ì¥ë“¤ì…ë‹ˆë‹¤:
            ${sentences.map(s => `- ${s.text} (${s.author})`).join('\n')}
            
            ì´ ë¬¸ì¥ë“¤ì„ ë¶„ì„í•˜ê³  ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ í”¼ë“œë°±ì„ ì œê³µí•´ì£¼ì„¸ìš”:
            1. ì „ì²´ì ì¸ í‰ê°€ (2-3ë¬¸ì¥)
            2. ì°½ì˜ì ì¸ í‘œí˜„ ì¹­ì°¬ (êµ¬ì²´ì  ì˜ˆì‹œ í¬í•¨)
            3. ë‹¤ìŒ í™œë™ì„ ìœ„í•œ ê²©ë ¤ ë©”ì‹œì§€
            
            í†¤: ì¹œê·¼í•˜ê³  ê²©ë ¤í•˜ëŠ”, ì´ˆë“±í•™ìƒ ìˆ˜ì¤€ì— ë§ëŠ” ì–¸ì–´ ì‚¬ìš©
        `;
        
        const result = await model.generateContent(prompt);
        const feedback = result.response.text();
        
        // ì‚¬ìš©ëŸ‰ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
        await updateAPIUsage(teacherId);
        
        // í”¼ë“œë°± ì €ì¥
        await admin.firestore()
            .doc(`classrooms/${classId}/activities/${activityId}`)
            .update({
                aiFeedback: feedback,
                feedbackGeneratedAt: admin.firestore.FieldValue.serverTimestamp(),
                feedbackModel: 'gemini-pro'
            });
        
        return { success: true, feedback: feedback };
        
    } catch (error) {
        if (error.message.includes('API í‚¤')) {
            throw new functions.https.HttpsError('failed-precondition', 
                'API í‚¤ë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”. ëŒ€ì‹œë³´ë“œì˜ AI ì„¤ì •ì—ì„œ Gemini API í‚¤ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        }
        throw new functions.https.HttpsError('internal', 
            `AI í”¼ë“œë°± ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`);
    }
});
```

#### 1.1 ë°ì´í„° ìˆ˜ì • ê¸°ëŠ¥ (1ì£¼ì°¨)
**ì˜ˆìƒ ê³µìˆ˜: 15ì‹œê°„**

```javascript
// êµ¬í˜„í•  API í•¨ìˆ˜ë“¤
// functions/index.js
exports.updateClassroom = functions.https.onCall(async (data, context) => {
    const { classId, updates } = data;
    
    // ê¶Œí•œ í™•ì¸: êµì‚¬ë§Œ ìˆ˜ì • ê°€ëŠ¥
    if (!context.auth || !context.auth.uid) {
        throw new functions.https.HttpsError('unauthenticated', 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
    }
    
    // í´ë˜ìŠ¤ ì†Œìœ ì í™•ì¸
    const classDoc = await admin.firestore().doc(`classrooms/${classId}`).get();
    if (!classDoc.exists || classDoc.data().teacherId !== context.auth.uid) {
        throw new functions.https.HttpsError('permission-denied', 'ìˆ˜ì • ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.');
    }
    
    // í—ˆìš©ëœ í•„ë“œë§Œ ì—…ë°ì´íŠ¸
    const allowedFields = ['className', 'description'];
    const filteredUpdates = {};
    for (const [key, value] of Object.entries(updates)) {
        if (allowedFields.includes(key)) {
            filteredUpdates[key] = value;
        }
    }
    
    await admin.firestore().doc(`classrooms/${classId}`).update({
        ...filteredUpdates,
        updatedAt: admin.firestore.FieldValue.serverTimestamp()
    });
    
    return { success: true, message: 'í´ë˜ìŠ¤ ì •ë³´ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.' };
});
```

**UI êµ¬í˜„:**
```html
<!-- dashboard.htmlì— ì¶”ê°€ -->
<div class="class-item">
    <div class="class-info">
        <h4 class="class-name-display">${classroom.className}</h4>
        <input class="class-name-edit hidden" value="${classroom.className}">
    </div>
    <div class="class-actions">
        <button class="edit-class-btn" data-id="${classId}">âœï¸ ìˆ˜ì •</button>
        <button class="save-class-btn hidden" data-id="${classId}">ğŸ’¾ ì €ì¥</button>
        <button class="cancel-edit-btn hidden">âŒ ì·¨ì†Œ</button>
    </div>
</div>
```

#### 1.2 í™œë™ íˆìŠ¤í† ë¦¬ ê´€ë¦¬ (2ì£¼ì°¨)
**ì˜ˆìƒ ê³µìˆ˜: 20ì‹œê°„**

**ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ í™•ì¥:**
```javascript
// classrooms/{classId}/activities/{activityId}
{
    title: "ë´„ í’ê²½ ë¬˜ì‚¬í•˜ê¸°",
    description: "ë´„ ì´ë¯¸ì§€ë¥¼ ë³´ê³  ê°ì„±ì ì¸ ë¬¸ì¥ ë§Œë“¤ê¸°",
    imageUrl1: "https://...",
    imageUrl2: "https://...",
    status: "completed", // "draft", "in_progress", "completed"
    createdAt: timestamp,
    completedAt: timestamp,
    participantCount: 25,
    resultSummary: {
        totalWords: 120,
        totalSentences: 45,
        topKeywords: ["ë´„", "ê½ƒ", "ë”°ëœ»í•œ"],
        averageWordsPerSentence: 2.7
    }
}
```

#### 1.3 AI í”¼ë“œë°± ìˆ˜ë™ ìƒì„± (2ì£¼ì°¨)
**ì˜ˆìƒ ê³µìˆ˜: 12ì‹œê°„**

```javascript
// ê¸°ì¡´ ìë™ íŠ¸ë¦¬ê±° ì œê±° ë° ìˆ˜ë™ í•¨ìˆ˜ ì¶”ê°€
exports.generateAIFeedback = functions.https.onCall(async (data, context) => {
    const { classId, activityId } = data;
    
    // ê¶Œí•œ í™•ì¸ í›„ OpenAI API í˜¸ì¶œ
    const sentences = await getSentencesForActivity(classId, activityId);
    const feedback = await openai.chat.completions.create({
        model: "gpt-3.5-turbo",
        messages: [{
            role: "user", 
            content: `ë‹¤ìŒ í•™ìƒë“¤ì˜ ì°½ì‘ ë¬¸ì¥ì„ ë¶„ì„í•˜ê³  ê²©ë ¤í•˜ëŠ” í”¼ë“œë°±ì„ ì œê³µí•´ì£¼ì„¸ìš”: ${sentences.join(', ')}`
        }]
    });
    
    // í”¼ë“œë°± ì €ì¥
    await admin.firestore()
        .doc(`classrooms/${classId}/activities/${activityId}`)
        .update({
            aiFeedback: feedback.choices[0].message.content,
            feedbackGeneratedAt: admin.firestore.FieldValue.serverTimestamp()
        });
        
    return { success: true, feedback: feedback.choices[0].message.content };
});
```

#### 1.3 AI í”¼ë“œë°± ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ê°œì„  (2ì£¼ì°¨)
**ì˜ˆìƒ ê³µìˆ˜: 8ì‹œê°„**

**ë¬¸ì œ**: ê¸°ì¡´ì—ëŠ” AI í”¼ë“œë°± ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•œ í›„ ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì•¼ ìƒì„±ëœ í”¼ë“œë°±ì„ ë³¼ ìˆ˜ ìˆì—ˆìŒ.

**í•´ê²°ì±…**: onSnapshot ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í•˜ì—¬ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ êµ¬í˜„

```javascript
// experiment-details.js - AI í”¼ë“œë°± ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ì¶”ê°€
const generateAIFeedbackWithRealTimeUpdate = async (classId, activityId) => {
    try {
        // ë¡œë”© ìƒíƒœ í‘œì‹œ
        const feedbackContainer = document.getElementById('ai-feedback-container');
        feedbackContainer.innerHTML = `
            <div class="loading-state">
                <div class="spinner"></div>
                <p>AIê°€ í”¼ë“œë°±ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤... (ìµœëŒ€ 30ì´ˆ)</p>
            </div>
        `;
        
        // ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ ì„¤ì • (Cloud Function í˜¸ì¶œ ì „ì— ì„¤ì •)
        const activityRef = db.doc(`classrooms/${classId}/activities/${activityId}`);
        let feedbackListener;
        let timeoutId;
        
        const cleanupListeners = () => {
            if (feedbackListener) {
                feedbackListener();
            }
            if (timeoutId) {
                clearTimeout(timeoutId);
            }
        };
        
        // 30ì´ˆ íƒ€ì„ì•„ì›ƒ ì„¤ì •
        timeoutId = setTimeout(() => {
            cleanupListeners();
            feedbackContainer.innerHTML = `
                <div class="timeout-message">
                    <p>â° AI í”¼ë“œë°± ìƒì„±ì´ ì˜ˆìƒë³´ë‹¤ ì˜¤ë˜ ê±¸ë¦¬ê³  ìˆìŠµë‹ˆë‹¤.</p>
                    <p>ì ì‹œ í›„ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.</p>
                    <button onclick="location.reload()" class="btn btn-secondary">ìƒˆë¡œê³ ì¹¨</button>
                </div>
            `;
        }, 30000);
        
        // ì‹¤ì‹œê°„ í”¼ë“œë°± ê°ì§€
        feedbackListener = activityRef.onSnapshot((doc) => {
            if (doc.exists) {
                const data = doc.data();
                if (data.aiFeedback && data.feedbackGeneratedAt) {
                    // ìƒˆë¡œìš´ í”¼ë“œë°±ì´ ìƒì„±ë¨
                    cleanupListeners();
                    displayAIFeedback(data.aiFeedback, data.feedbackGeneratedAt.toDate());
                }
            }
        });
        
        // Cloud Function í˜¸ì¶œ
        const result = await firebase.functions().httpsCallable('generateAIFeedbackWithPersonalKey')({
            classId: classId,
            activityId: activityId
        });
        
        // ë§Œì•½ ì¦‰ì‹œ ì‘ë‹µì´ ì™”ë‹¤ë©´ ë¦¬ìŠ¤ë„ˆ ì •ë¦¬
        if (result.data.success) {
            cleanupListeners();
            displayAIFeedback(result.data.feedback, new Date());
        }
        
    } catch (error) {
        console.error('AI feedback generation failed:', error);
        document.getElementById('ai-feedback-container').innerHTML = `
            <div class="error-state">
                <p>âŒ AI í”¼ë“œë°± ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
                <p>${error.message}</p>
                <button onclick="generateAIFeedbackWithRealTimeUpdate('${classId}', '${activityId}')" 
                        class="btn btn-primary">ë‹¤ì‹œ ì‹œë„</button>
            </div>
        `;
    }
};

const displayAIFeedback = (feedback, generatedAt) => {
    const container = document.getElementById('ai-feedback-container');
    container.innerHTML = `
        <div class="ai-feedback-success">
            <div class="feedback-header">
                <h4>ğŸ¤– AI í”¼ë“œë°±</h4>
                <small class="generated-time">${generatedAt.toLocaleString()} ìƒì„±</small>
            </div>
            <div class="feedback-content">
                ${feedback.replace(/\n/g, '<br>')}
            </div>
            <div class="feedback-actions">
                <button onclick="regenerateAIFeedback()" class="btn btn-secondary btn-sm">
                    ğŸ”„ ë‹¤ì‹œ ìƒì„±
                </button>
            </div>
        </div>
    `;
};
```

#### 1.4 ì‚¬ìš©ì ê²½í—˜ ê°œì„  (3ì£¼ì°¨)  
**ì˜ˆìƒ ê³µìˆ˜: 10ì‹œê°„**

**ë¡œë”© ìƒíƒœ & ì—ëŸ¬ ì²˜ë¦¬:**
```javascript
// ê³µí†µ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
const showLoadingSpinner = (elementId) => {
    document.getElementById(elementId).innerHTML = `
        <div class="flex justify-center items-center p-8">
            <div class="spinner"></div>
            <span class="ml-3">ì²˜ë¦¬ ì¤‘...</span>
        </div>
    `;
};

const showError = (elementId, message) => {
    document.getElementById(elementId).innerHTML = `
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
            <strong>ì˜¤ë¥˜:</strong> ${message}
            <button onclick="location.reload()" class="ml-4 underline">ë‹¤ì‹œ ì‹œë„</button>
        </div>
    `;
};
```

---

### ğŸ“ˆ **2ë‹¨ê³„: í•µì‹¬ ê¸°ëŠ¥ í™•ì¥ (4-6ì£¼)**

#### ëª©í‘œ: ë‚±ë§ íƒí—˜ ì‹œìŠ¤í…œ êµ¬ì¶• ë° ê°œì¸í™” í•™ìŠµ ê²½í—˜ ì œê³µ

#### 2.0 ì²¨ë¶€íŒŒì¼ ê´€ë¦¬ ì‹œìŠ¤í…œ (4ì£¼ì°¨)
**ì˜ˆìƒ ê³µìˆ˜: 25ì‹œê°„**

**ì „ì²´ ê°œë°œ ê³„íš ìš”ì•½:**

##### Phase 1: ì¸í”„ë¼ êµ¬ì¶•
- Firebase Storage íŒŒì¼ êµ¬ì¡° ì„¤ê³„
- Firestore ë©”íƒ€ë°ì´í„° ëª¨ë¸ êµ¬ì„±
- ë³´ì•ˆ ê·œì¹™ ë° ì ‘ê·¼ ê¶Œí•œ ì„¤ì •

##### Phase 2: UI êµ¬í˜„
- íŒŒì¼ ì—…ë¡œë“œ ì¸í„°í˜ì´ìŠ¤
- ì†ê¸€ì”¨ ìº”ë²„ìŠ¤ ëª¨ë‹¬ ë° ë“œë¡œì‰ ë„êµ¬
- ì²¨ë¶€íŒŒì¼ ë¯¸ë¦¬ë³´ê¸° ë° ê´€ë¦¬ UI

##### Phase 3: JavaScript êµ¬í˜„
- AttachmentManager í´ë˜ìŠ¤ ê°œë°œ
- HandwritingCanvas í´ë˜ìŠ¤ ê°œë°œ
- ì‹¤ì‹œê°„ ì²¨ë¶€íŒŒì¼ ë™ê¸°í™” ê¸°ëŠ¥

##### Phase 4: í†µí•©
- ë³´ê³ ì„œ ì œì¶œ ì‹œ ì²¨ë¶€íŒŒì¼ í†µí•©
- êµì‚¬ìš© ì²¨ë¶€íŒŒì¼ ê°¤ëŸ¬ë¦¬ ë·°
- í•™ìƒ í¬íŠ¸í´ë¦¬ì˜¤ ì²¨ë¶€íŒŒì¼ í‘œì‹œ

##### Phase 5: ê³ ê¸‰ ê¸°ëŠ¥
- ì´ë¯¸ì§€ í¸ì§‘ ê¸°ëŠ¥
- êµì‚¬ ì£¼ì„ ì‹œìŠ¤í…œ
- ì²¨ë¶€íŒŒì¼ ë²„ì „ ê´€ë¦¬
- ëª¨ë°”ì¼ ìµœì í™” ë° ì¹´ë©”ë¼ ì—°ë™

##### Phase 6: ì„±ëŠ¥ ë° ë³´ì•ˆ
- íŒŒì¼ ì••ì¶• ë° ìµœì í™”
- ë³´ì•ˆ ê²€ì¦ ë° ë°”ì´ëŸ¬ìŠ¤ ìŠ¤ìº”
- ì €ì¥ ìš©ëŸ‰ ê´€ë¦¬

**êµ¬í˜„ ì˜ˆì‹œ ì½”ë“œ (íŒŒì¼ ì—…ë¡œë“œ ì‹œìŠ¤í…œ):**
```javascript
// AttachmentManager í´ë˜ìŠ¤ êµ¬í˜„
class AttachmentManager {
    constructor(userId, classId, activityId) {
        this.userId = userId;
        this.classId = classId;
        this.activityId = activityId;
        this.storageRef = firebase.storage().ref();
        this.db = firebase.firestore();
        this.attachments = [];
        this.maxFileSize = 5 * 1024 * 1024; // 5MB
        this.allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'application/pdf'];
    }
    
    // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
    async uploadFile(file) {
        // íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬
        if (!this.validateFile(file)) {
            throw new Error('íŒŒì¼ í¬ê¸° ë˜ëŠ” ìœ í˜•ì´ í—ˆìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
        }
        
        // ê³ ìœ  íŒŒì¼ëª… ìƒì„± (timestamp + ì›ë³¸íŒŒì¼ëª…)
        const timestamp = new Date().getTime();
        const fileName = `${timestamp}_${file.name}`;
        const filePath = `attachments/${this.classId}/${this.activityId}/${this.userId}/${fileName}`;
        
        // Storageì— ì—…ë¡œë“œ
        const fileRef = this.storageRef.child(filePath);
        const uploadTask = fileRef.put(file);
        
        return new Promise((resolve, reject) => {
            uploadTask.on('state_changed', 
                // ì§„í–‰ ìƒíƒœ ì—…ë°ì´íŠ¸
                (snapshot) => {
                    const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                    console.log(`Upload progress: ${progress}%`);
                },
                // ì˜¤ë¥˜ ì²˜ë¦¬
                (error) => {
                    console.error('Upload failed:', error);
                    reject(error);
                },
                // ì™„ë£Œ ì²˜ë¦¬
                async () => {
                    // ë‹¤ìš´ë¡œë“œ URL ê°€ì ¸ì˜¤ê¸°
                    const downloadURL = await uploadTask.snapshot.ref.getDownloadURL();
                    
                    // Firestoreì— ë©”íƒ€ë°ì´í„° ì €ì¥
                    const attachmentData = {
                        fileName: file.name,
                        fileType: file.type,
                        fileSize: file.size,
                        storagePath: filePath,
                        downloadURL: downloadURL,
                        uploadedAt: firebase.firestore.FieldValue.serverTimestamp(),
                        uploadedBy: this.userId,
                        status: 'active'
                    };
                    
                    // ì²¨ë¶€íŒŒì¼ ë©”íƒ€ë°ì´í„° Firestoreì— ì €ì¥
                    await this.db.collection(`classrooms/${this.classId}/activities/${this.activityId}/attachments`)
                        .add(attachmentData);
                    
                    resolve({
                        success: true,
                        fileData: attachmentData
                    });
                }
            );
        });
    }
    
    // íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬
    validateFile(file) {
        if (file.size > this.maxFileSize) {
            console.error(`File too large: ${file.size} bytes`);
            return false;
        }
        
        if (!this.allowedTypes.includes(file.type)) {
            console.error(`File type not allowed: ${file.type}`);
            return false;
        }
        
        return true;
    }
    
    // ì²¨ë¶€íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
    async getAttachments() {
        const snapshot = await this.db
            .collection(`classrooms/${this.classId}/activities/${this.activityId}/attachments`)
            .where('uploadedBy', '==', this.userId)
            .where('status', '==', 'active')
            .orderBy('uploadedAt', 'desc')
            .get();
        
        this.attachments = [];
        snapshot.forEach(doc => {
            this.attachments.push({
                id: doc.id,
                ...doc.data()
            });
        });
        
        return this.attachments;
    }
    
    // ì²¨ë¶€íŒŒì¼ ì‚­ì œ
    async deleteAttachment(attachmentId) {
        const docRef = this.db
            .doc(`classrooms/${this.classId}/activities/${this.activityId}/attachments/${attachmentId}`);
        
        const doc = await docRef.get();
        if (!doc.exists) {
            throw new Error('ì²¨ë¶€íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
        
        const data = doc.data();
        
        // Storageì—ì„œ íŒŒì¼ ì‚­ì œ
        await this.storageRef.child(data.storagePath).delete();
        
        // Firestoreì—ì„œ ë©”íƒ€ë°ì´í„° ì‚­ì œ (ë˜ëŠ” status ë³€ê²½)
        await docRef.update({
            status: 'deleted',
            deletedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        return { success: true };
    }
}
```

**ì†ê¸€ì”¨ ìº”ë²„ìŠ¤ êµ¬í˜„:**
```javascript
// HandwritingCanvas í´ë˜ìŠ¤
class HandwritingCanvas {
    constructor(canvasElement, options = {}) {
        this.canvas = canvasElement;
        this.context = this.canvas.getContext('2d');
        this.isDrawing = false;
        this.lastX = 0;
        this.lastY = 0;
        
        // ê¸°ë³¸ ì„¤ì •
        this.lineWidth = options.lineWidth || 3;
        this.lineColor = options.lineColor || '#000000';
        this.backgroundColor = options.backgroundColor || '#ffffff';
        
        // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
        this.clearCanvas();
        
        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        this.setupEventListeners();
    }
    
    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
    setupEventListeners() {
        // í„°ì¹˜ ë° ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ ì²˜ë¦¬
        this.canvas.addEventListener('mousedown', this.startDrawing.bind(this));
        this.canvas.addEventListener('mousemove', this.draw.bind(this));
        this.canvas.addEventListener('mouseup', this.stopDrawing.bind(this));
        this.canvas.addEventListener('mouseout', this.stopDrawing.bind(this));
        
        // í„°ì¹˜ ì´ë²¤íŠ¸
        this.canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            this.startDrawing(this.getTouchPos(e));
        });
        
        this.canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            this.draw(this.getTouchPos(e));
        });
        
        this.canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            this.stopDrawing();
        });
    }
    
    // í„°ì¹˜ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
    getTouchPos(touchEvent) {
        const rect = this.canvas.getBoundingClientRect();
        const touch = touchEvent.touches[0];
        
        return {
            clientX: touch.clientX - rect.left,
            clientY: touch.clientY - rect.top
        };
    }
    
    // ê·¸ë¦¬ê¸° ì‹œì‘
    startDrawing(e) {
        this.isDrawing = true;
        [this.lastX, this.lastY] = [e.clientX - this.canvas.offsetLeft, e.clientY - this.canvas.offsetTop];
    }
    
    // ê·¸ë¦¬ê¸°
    draw(e) {
        if (!this.isDrawing) return;
        
        const x = e.clientX - this.canvas.offsetLeft;
        const y = e.clientY - this.canvas.offsetTop;
        
        // ì„  ê·¸ë¦¬ê¸°
        this.context.beginPath();
        this.context.moveTo(this.lastX, this.lastY);
        this.context.lineTo(x, y);
        this.context.lineWidth = this.lineWidth;
        this.context.strokeStyle = this.lineColor;
        this.context.lineCap = 'round';
        this.context.lineJoin = 'round';
        this.context.stroke();
        
        [this.lastX, this.lastY] = [x, y];
    }
    
    // ê·¸ë¦¬ê¸° ì¤‘ì§€
    stopDrawing() {
        this.isDrawing = false;
    }
    
    // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
    clearCanvas() {
        this.context.fillStyle = this.backgroundColor;
        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);
    }
    
    // ì„¤ì • ë³€ê²½
    setOptions(options) {
        if (options.lineWidth) this.lineWidth = options.lineWidth;
        if (options.lineColor) this.lineColor = options.lineColor;
        if (options.backgroundColor) {
            this.backgroundColor = options.backgroundColor;
            this.clearCanvas(); // ë°°ê²½ìƒ‰ ë³€ê²½ ì‹œ ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
        }
    }
    
    // ì´ë¯¸ì§€ë¡œ ë³€í™˜
    async toImage(format = 'image/png', quality = 0.8) {
        return new Promise((resolve) => {
            const imageData = this.canvas.toDataURL(format, quality);
            resolve(imageData);
        });
    }
    
    // Blobìœ¼ë¡œ ë³€í™˜ (ì—…ë¡œë“œìš©)
    async toBlob(format = 'image/png', quality = 0.8) {
        return new Promise((resolve) => {
            this.canvas.toBlob((blob) => {
                resolve(blob);
            }, format, quality);
        });
    }
}
```



#### 2.1 ë‚±ë§ íƒí—˜ ì‹œìŠ¤í…œ (4-5ì£¼ì°¨)
**ì˜ˆìƒ ê³µìˆ˜: 35ì‹œê°„**

**ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ:**
```javascript
// í•™ìƒ ê°œì¸ ë°ì´í„°
// classrooms/{classId}/students/{studentId}
{
    name: "ê¹€ë¯¼ì§€", // ì‹¤ëª… ë˜ëŠ” ë‹‰ë„¤ì„
    anonymousId: "user_anonymous_id", // ìµëª… ì‚¬ìš©ìì™€ ì—°ê²°
    wordCollection: [
        {
            word: "í™©í™€í•œ",
            category: "í˜•ìš©ì‚¬",
            source: "ai_suggestion", // "ai_suggestion", "user_input", "dictionary"
            discoveredAt: timestamp,
            usedInSentences: ["í™©í™€í•œ ë…¸ì„ì´ ì§€ê³  ìˆë‹¤."]
        }
    ],
    activityHistory: [
        {
            activityId: "activity_001",
            wordsDiscovered: 5,
            sentencesCreated: 2,
            peersLiked: 3,
            pointsEarned: 25
        }
    ],
    totalPoints: 150,
    level: 3,
    badges: ["first_sentence", "word_explorer", "popular_author"]
}
```

**ë‚±ë§ íƒí—˜ ëª¨ë‹¬ UI:**
```html
<!-- ë‚±ë§ íƒí—˜ íŒì—… -->
<div id="word-exploration-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <h2 class="text-2xl font-bold text-center mb-4">
                    ğŸ” "<span id="exploration-word"></span>" ë‚±ë§ íƒí—˜
                </h2>
                
                <!-- íƒ­ ë©”ë‰´ -->
                <div class="flex border-b mb-4">
                    <button class="tab-btn active" data-category="adjectives">âœ¨ ê´€ë ¨ í˜•ìš©ì‚¬</button>
                    <button class="tab-btn" data-category="verbs">ğŸƒ ì–´ìš¸ë¦¬ëŠ” ë™ì‚¬</button>
                    <button class="tab-btn" data-category="metaphors">ğŸ­ ë¹„ìœ  í‘œí˜„</button>
                    <button class="tab-btn" data-category="opposites">âš–ï¸ ë°˜ëŒ€ë§</button>
                </div>
                
                <!-- íƒ­ ì½˜í…ì¸  -->
                <div id="exploration-content" class="mb-6">
                    <!-- ë‚±ë§ ì¹´ë“œë“¤ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                </div>
                
                <!-- ê°œì¸ ë°œê²¬ ì…ë ¥ -->
                <div class="bg-yellow-50 p-4 rounded-lg">
                    <h3 class="font-bold mb-2">âœ¨ ë‚´ê°€ ë°œê²¬í•œ ë¹„ìŠ·í•œ ë‚±ë§</h3>
                    <div class="flex gap-2">
                        <input type="text" id="personal-word-input" 
                               placeholder="ë– ì˜¤ë¥´ëŠ” ë‹¨ì–´ë¥¼ ì…ë ¥í•´ë³´ì„¸ìš”!" 
                               class="flex-1 p-2 border rounded-lg">
                        <button id="add-personal-word-btn" class="bg-yellow-500 text-white px-4 py-2 rounded-lg">
                            ì¶”ê°€í•˜ê¸°
                        </button>
                    </div>
                </div>
                
                <!-- ë‚˜ì˜ ë‚±ë§ ê¾¸ëŸ¬ë¯¸ -->
                <div class="mt-4">
                    <h3 class="font-bold mb-2">ğŸ’ ë‚˜ì˜ ë‚±ë§ ê¾¸ëŸ¬ë¯¸</h3>
                    <div id="word-collection-display" class="flex flex-wrap gap-2">
                        <!-- ìˆ˜ì§‘í•œ ë‚±ë§ë“¤ì´ í‘œì‹œë¨ -->
                    </div>
                </div>
                
                <div class="flex justify-end gap-2 mt-6">
                    <button id="close-exploration-btn" class="px-4 py-2 border rounded-lg">ë‹«ê¸°</button>
                </div>
            </div>
        </div>
    </div>
</div>
```

**API ì—°ë™ ë¡œì§:**
```javascript
// ë‚±ë§ í™•ì¥ API (ì™¸ë¶€ ì‚¬ì „ ì—°ë™)
const exploreWord = async (word, category) => {
    try {
        // Option 1: ìœ„í‚¤ë‚±ë§ì‚¬ì „ API (ë¬´ë£Œ)
        const response = await fetch(`https://ko.wiktionary.org/api/rest_v1/page/summary/${word}`);
        
        // Option 2: ë„¤ì´ë²„ ì‚¬ì „ API (ìœ ë£Œ)
        // const response = await fetch(`https://openapi.naver.com/v1/search/encyc.json?query=${word}`);
        
        // Option 3: OpenAIë¥¼ ì‚¬ìš©í•œ ì–´íœ˜ í™•ì¥
        const aiResponse = await functions.httpsCallable('expandVocabulary')({
            word: word,
            category: category
        });
        
        return aiResponse.data;
    } catch (error) {
        console.error('Word exploration failed:', error);
        return { suggestions: [] };
    }
};

// Cloud Function
exports.expandVocabulary = functions.https.onCall(async (data) => {
    const { word, category } = data;
    
    const prompts = {
        adjectives: `"${word}"ì™€ ê´€ë ¨ëœ í˜•ìš©ì‚¬ 5ê°œë¥¼ ì œì•ˆí•´ì£¼ì„¸ìš”. ì´ˆë“±í•™ìƒì´ ì´í•´í•  ìˆ˜ ìˆëŠ” ë‹¨ì–´ë¡œë§Œ êµ¬ì„±í•´ì£¼ì„¸ìš”.`,
        verbs: `"${word}"ì™€ ì–´ìš¸ë¦¬ëŠ” ë™ì‚¬ 5ê°œë¥¼ ì œì•ˆí•´ì£¼ì„¸ìš”.`,
        metaphors: `"${word}"ë¥¼ ì‚¬ìš©í•œ ë¹„ìœ ì  í‘œí˜„ 3ê°œë¥¼ ì œì•ˆí•´ì£¼ì„¸ìš”.`,
        opposites: `"${word}"ì˜ ë°˜ëŒ€ë§ì´ë‚˜ ëŒ€ì¡°ë˜ëŠ” ë‹¨ì–´ë“¤ì„ 3ê°œ ì œì•ˆí•´ì£¼ì„¸ìš”.`
    };
    
    const completion = await openai.chat.completions.create({
        model: "gpt-3.5-turbo",
        messages: [{
            role: "user",
            content: prompts[category]
        }],
        temperature: 0.7
    });
    
    // ì‘ë‹µì„ íŒŒì‹±í•˜ì—¬ ë‹¨ì–´ ë°°ì—´ë¡œ ë³€í™˜
    const suggestions = parseAIResponse(completion.choices[0].message.content);
    
    return { suggestions };
});
```

#### 2.2 ê²Œì„í™” ì‹œìŠ¤í…œ (5ì£¼ì°¨)
**ì˜ˆìƒ ê³µìˆ˜: 25ì‹œê°„**

**í¬ì¸íŠ¸ & ë ˆë²¨ ì‹œìŠ¤í…œ:**
```javascript
// í¬ì¸íŠ¸ ê³„ì‚° ë¡œì§
const calculatePoints = (action, context) => {
    const pointSystem = {
        WORD_DISCOVERY: 5,           // ìƒˆ ë‚±ë§ ë°œê²¬
        PERSONAL_WORD_ADD: 10,       // ê°œì¸ ë‚±ë§ ì¶”ê°€
        SENTENCE_CREATION: 15,       // ë¬¸ì¥ ì°½ì‘
        PEER_LIKE_RECEIVED: 3,       // ê³µê° ë°›ê¸°
        PEER_LIKE_GIVEN: 2,          // ê³µê° ì£¼ê¸°
        EXPLORATION_COMPLETE: 20,    // íƒí—˜ ì™„ë£Œ
        CREATIVE_BONUS: 10           // ì°½ì˜ì„± ë³´ë„ˆìŠ¤ (AI íŒì •)
    };
    
    return pointSystem[action] || 0;
};

// ë°°ì§€ íšë“ ì¡°ê±´
const checkBadgeEarned = (studentData) => {
    const badges = [];
    
    if (studentData.activityHistory.length === 1) {
        badges.push({
            id: 'first_activity',
            title: 'ì²« ë°œê±¸ìŒ',
            description: 'ì²« ë²ˆì§¸ í™œë™ì— ì°¸ì—¬í–ˆì–´ìš”!',
            icon: 'ğŸ‘¶',
            earnedAt: new Date()
        });
    }
    
    if (studentData.wordCollection.length >= 10) {
        badges.push({
            id: 'word_collector',
            title: 'ë‚±ë§ ìˆ˜ì§‘ê°€',
            description: '10ê°œì˜ ë‚±ë§ì„ ìˆ˜ì§‘í–ˆì–´ìš”!',
            icon: 'ğŸ“š'
        });
    }
    
    const totalLikes = studentData.activityHistory.reduce((sum, activity) => 
        sum + activity.peersLiked, 0);
    if (totalLikes >= 10) {
        badges.push({
            id: 'popular_author',
            title: 'ì¸ê¸° ì‘ê°€',
            description: '10ê°œ ì´ìƒì˜ ê³µê°ì„ ë°›ì•˜ì–´ìš”!',
            icon: 'â­'
        });
    }
    
    return badges;
};
```

#### 2.3 í•™ìƒ í¬íŠ¸í´ë¦¬ì˜¤ ì‹œìŠ¤í…œ (6ì£¼ì°¨)
**ì˜ˆìƒ ê³µìˆ˜: 30ì‹œê°„**

**í¬íŠ¸í´ë¦¬ì˜¤ UI:**
```html
<!-- student-portfolio.html -->
<div class="portfolio-container">
    <header class="student-profile">
        <div class="avatar">ğŸ‘§</div>
        <div class="info">
            <h2 id="student-name">ê¹€ë¯¼ì§€</h2>
            <div class="level-info">
                <span class="level">Level 3</span>
                <div class="progress-bar">
                    <div class="progress" style="width: 65%"></div>
                </div>
                <span class="points">150/200 í¬ì¸íŠ¸</span>
            </div>
        </div>
    </header>
    
    <section class="badges">
        <h3>ğŸ† íšë“í•œ ë°°ì§€</h3>
        <div class="badge-grid">
            <div class="badge">
                <div class="badge-icon">ğŸ‘¶</div>
                <div class="badge-name">ì²« ë°œê±¸ìŒ</div>
            </div>
            <div class="badge">
                <div class="badge-icon">ğŸ“š</div>
                <div class="badge-name">ë‚±ë§ ìˆ˜ì§‘ê°€</div>
            </div>
        </div>
    </section>
    
    <section class="word-collection">
        <h3>ğŸ’ ë‚˜ì˜ ë‚±ë§ ê¾¸ëŸ¬ë¯¸</h3>
        <div class="word-cloud">
            <!-- ìˆ˜ì§‘í•œ ë‚±ë§ë“¤ì„ í¬ê¸°ë³„ë¡œ í‘œì‹œ -->
        </div>
    </section>
    
    <section class="activity-timeline">
        <h3>ğŸ“… í™œë™ ê¸°ë¡</h3>
        <div class="timeline">
            <!-- í™œë™ íˆìŠ¤í† ë¦¬ í‘œì‹œ -->
        </div>
    </section>
    
    <section class="growth-chart">
        <h3>ğŸ“ˆ ì„±ì¥ ê·¸ë˜í”„</h3>
        <canvas id="growth-chart"></canvas>
    </section>
</div>
```

---

### ğŸ¤– **3ë‹¨ê³„: AI ê³ ë„í™” (6-8ì£¼)**

#### ëª©í‘œ: ê°œì¸í™”ëœ AI íŠœí„° ì‹œìŠ¤í…œ êµ¬ì¶•

#### 3.1 ê°œì¸í™” AI íŠœí„° (7-8ì£¼ì°¨)
**ì˜ˆìƒ ê³µìˆ˜: 40ì‹œê°„**

**AI í˜ë¥´ì†Œë‚˜ ì‹œìŠ¤í…œ:**
```javascript
// AI íŠœí„° ê°œì¸í™” ì„¤ì •
const createPersonalizedTutor = (studentProfile, activityContext) => {
    const tutorPersonas = {
        encouraging: {
            name: "ë¯¸ì†ŒìŒ¤",
            personality: "í•­ìƒ ê²©ë ¤í•˜ê³  ê¸ì •ì ì¸ í”¼ë“œë°±ì„ ì œê³µ",
            responseStyle: "gentle",
            emoji: "ğŸ˜Š"
        },
        challenging: {
            name: "ë„ì „ì´",
            personality: "ì ì ˆí•œ ë„ì „ê³¼ ë°œì „ ë°©í–¥ì„ ì œì‹œ",
            responseStyle: "motivating",
            emoji: "ğŸš€"
        },
        creative: {
            name: "ìƒìƒì´",
            personality: "ì°½ì˜ì  ì‚¬ê³ ë¥¼ ìê·¹í•˜ê³  ì˜ê°ì„ ì œê³µ",
            responseStyle: "inspiring",
            emoji: "ğŸ¨"
        }
    };
    
    // í•™ìƒ ì„±í–¥ì— ë”°ë¥¸ íŠœí„° ì„ íƒ
    let selectedTutor;
    if (studentProfile.creativityLevel < 3) {
        selectedTutor = tutorPersonas.encouraging;
    } else if (studentProfile.averageParticipation > 0.8) {
        selectedTutor = tutorPersonas.challenging;
    } else {
        selectedTutor = tutorPersonas.creative;
    }
    
    return selectedTutor;
};

// ê°œì¸í™”ëœ ì‘ë‹µ ìƒì„±
exports.generatePersonalizedFeedback = functions.https.onCall(async (data) => {
    const { studentId, word, context, activityType } = data;
    
    // í•™ìƒ í”„ë¡œí•„ ë¡œë“œ
    const studentProfile = await getStudentProfile(studentId);
    const tutor = createPersonalizedTutor(studentProfile, context);
    
    const personalizedPrompt = `
        ë‹¹ì‹ ì€ ${tutor.name}ì´ë¼ëŠ” ì´ˆë“±í•™ìƒ ëŒ€ìƒ AI íŠœí„°ì…ë‹ˆë‹¤.
        ì„±ê²©: ${tutor.personality}
        
        í•™ìƒ ì •ë³´:
        - ë ˆë²¨: ${studentProfile.level}
        - ì°¸ì—¬ë„: ${studentProfile.participationRate}
        - ê°•ì : ${studentProfile.strengths.join(', ')}
        
        í•™ìƒì´ "${word}"ë¼ëŠ” ë‚±ë§ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
        
        ë‹¤ìŒ ì¡°ê±´ì— ë§ëŠ” í”¼ë“œë°±ì„ ì œê³µí•´ì£¼ì„¸ìš”:
        1. 2-3ë¬¸ì¥ìœ¼ë¡œ ê°„ê²°í•˜ê²Œ
        2. í•™ìƒì˜ ë ˆë²¨ì— ë§ëŠ” ì–¸ì–´ ì‚¬ìš©
        3. êµ¬ì²´ì ì¸ ì¹­ì°¬ê³¼ ë‹¤ìŒ ë‹¨ê³„ ì œì‹œ
        4. ${tutor.emoji} ì´ëª¨ì§€ í¬í•¨
    `;
    
    const completion = await openai.chat.completions.create({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: personalizedPrompt }],
        temperature: 0.8
    });
    
    return {
        feedback: completion.choices[0].message.content,
        tutorName: tutor.name,
        tutorEmoji: tutor.emoji
    };
});
```

#### 3.2 ì ì‘í˜• í•™ìŠµ ì§€ì› (8ì£¼ì°¨)
**ì˜ˆìƒ ê³µìˆ˜: 25ì‹œê°„**

**ë‚œì´ë„ ìë™ ì¡°ì ˆ ì‹œìŠ¤í…œ:**
```javascript
const adaptiveDifficultySystem = {
    // í•™ìƒ ìƒíƒœ ë¶„ì„
    analyzeStudentPerformance: (studentHistory) => {
        const recentActivities = studentHistory.slice(-3);
        
        const metrics = {
            completionRate: calculateCompletionRate(recentActivities),
            averageTimeSpent: calculateAverageTime(recentActivities),
            creativityScore: calculateCreativityScore(recentActivities),
            strugglingAreas: identifyStruggles(recentActivities)
        };
        
        return metrics;
    },
    
    // ë§ì¶¤í˜• ì§€ì› ì œê³µ
    provideSupportStrategy: (studentMetrics) => {
        if (studentMetrics.completionRate < 0.5) {
            return {
                type: 'basic_support',
                actions: [
                    'provide_word_suggestions',
                    'simplify_instructions',
                    'increase_encouragement'
                ],
                difficultyLevel: 'beginner'
            };
        } else if (studentMetrics.creativityScore > 8) {
            return {
                type: 'advanced_challenge',
                actions: [
                    'suggest_complex_expressions',
                    'encourage_metaphors',
                    'peer_mentoring_opportunity'
                ],
                difficultyLevel: 'advanced'
            };
        } else {
            return {
                type: 'standard_progression',
                actions: [
                    'balanced_word_suggestions',
                    'creative_prompts',
                    'peer_interaction'
                ],
                difficultyLevel: 'intermediate'
            };
        }
    }
};
```

---

## ğŸ›  ìƒì„¸ ê¸°ìˆ  ìŠ¤í™

### ğŸ“Š **í™•ì¥ëœ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ**

#### Firestore ì»¬ë ‰ì…˜ êµ¬ì¡°
```javascript
// ê¸°ì¡´ êµ¬ì¡° ìœ ì§€ + í™•ì¥
classrooms/{classId} {
    // ê¸°ì¡´ í•„ë“œ ìœ ì§€
    className: string,
    teacherId: string,
    joinCode: string,
    createdAt: timestamp,
    
    // ìƒˆë¡œ ì¶”ê°€ë  í•„ë“œ
    description?: string,
    settings: {
        allowAnonymousStudents: boolean,
        enableAITutor: boolean,
        pointSystemEnabled: boolean,
        maxStudents: number
    },
    
    // í•˜ìœ„ ì»¬ë ‰ì…˜ë“¤
    /activities/{activityId} - í™œë™ ê¸°ë¡
    /students/{studentId} - í•™ìƒ ê°œë³„ ë°ì´í„°
    /sharedImages/current - í˜„ì¬ ê³µìœ  ì´ë¯¸ì§€ (ê¸°ì¡´ ìœ ì§€)
    /appState/current - ì•± ìƒíƒœ (ê¸°ì¡´ ìœ ì§€)
    /words/{wordId} - ì‹¤ì‹œê°„ ë‚±ë§ (ê¸°ì¡´ ìœ ì§€)
    /sentences/{sentenceId} - ì‹¤ì‹œê°„ ë¬¸ì¥ (ê¸°ì¡´ ìœ ì§€)
}

// ìƒˆë¡œìš´ ì»¬ë ‰ì…˜
students/{studentId} {
    profile: {
        displayName: string,
        anonymousId: string, // ìµëª… ì‚¬ìš©ìì™€ ì—°ê²°
        currentClassId: string,
        joinedAt: timestamp
    },
    
    learning: {
        totalPoints: number,
        currentLevel: number,
        badges: array,
        preferences: {
            tutorPersona: string,
            difficultyLevel: string
        }
    },
    
    progress: {
        wordCollection: array,
        activityHistory: array,
        growthMetrics: {
            vocabularyGrowth: array,
            creativityTrend: array,
            participationRate: number
        }
    }
}
```

### ğŸ”§ **API ì„¤ê³„**

#### Cloud Functions ëª©ë¡
```javascript
// 1ë‹¨ê³„ í•¨ìˆ˜ë“¤
exports.updateClassroom = functions.https.onCall()     // í´ë˜ìŠ¤ ì •ë³´ ìˆ˜ì •
exports.getActivityHistory = functions.https.onCall()  // í™œë™ ì´ë ¥ ì¡°íšŒ  
exports.generateAIFeedback = functions.https.onCall()  // AI í”¼ë“œë°± ìˆ˜ë™ ìƒì„±

// 2ë‹¨ê³„ í•¨ìˆ˜ë“¤  
exports.exploreVocabulary = functions.https.onCall()   // ë‚±ë§ íƒí—˜
exports.addToWordCollection = functions.https.onCall() // ê°œì¸ ë‚±ë§ ìˆ˜ì§‘
exports.calculatePoints = functions.https.onCall()     // í¬ì¸íŠ¸ ê³„ì‚°
exports.generatePortfolio = functions.https.onCall()   // í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„±

// 3ë‹¨ê³„ í•¨ìˆ˜ë“¤
exports.getPersonalizedFeedback = functions.https.onCall() // ê°œì¸í™” í”¼ë“œë°±
exports.analyzeStudentProgress = functions.https.onCall()  // í•™ìŠµ ë¶„ì„
exports.recommendNextActivity = functions.https.onCall()   // í™œë™ ì¶”ì²œ
```

### ğŸ¨ **UI/UX ê°œì„ ì‚¬í•­**

#### ë°˜ì‘í˜• ë””ìì¸ ê°•í™”
```css
/* íƒœë¸”ë¦¿ ìµœì í™” */
@media (min-width: 768px) and (max-width: 1024px) {
    .word-exploration-modal {
        max-width: 90vw;
        max-height: 85vh;
    }
    
    .exploration-content {
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
    }
    
    .student-portfolio {
        grid-template-columns: 1fr 2fr;
    }
}

/* ëª¨ë°”ì¼ ìµœì í™” */
@media (max-width: 767px) {
    .word-card {
        font-size: 0.9rem;
        padding: 0.75rem;
    }
    
    .badge-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .portfolio-section {
        padding: 1rem;
    }
}
```

#### ë‹¤í¬ëª¨ë“œ ì§€ì›
```css
@media (prefers-color-scheme: dark) {
    :root {
        --bg-primary: #1a1a1a;
        --bg-secondary: #2d2d2d;
        --text-primary: #ffffff;
        --text-secondary: #b0b0b0;
        --accent-primary: #4f46e5;
    }
    
    .word-card {
        background: var(--bg-secondary);
        color: var(--text-primary);
        border: 1px solid #404040;
    }
}
```

---

## ğŸ“‹ **ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸**

### âœ… **1ë‹¨ê³„ ì™„ë£Œ ì¡°ê±´ (3-4ì£¼)**
- [ ] **Google ë¡œê·¸ì¸ ì‹œìŠ¤í…œ í†µí•©**
  - [ ] í•™ìƒìš© Google OAuth êµ¬í˜„
  - [ ] ìµëª…/Google ë¡œê·¸ì¸ ì„ íƒ UI
  - [ ] ê°œì¸ í¬íŠ¸í´ë¦¬ì˜¤ ì—°ê²° ê¸°ëŠ¥
- [ ] **QR ì½”ë“œ í´ë˜ìŠ¤ ì°¸ì—¬ ì‹œìŠ¤í…œ**
  - [ ] êµì‚¬ìš© QR ì½”ë“œ ìƒì„± ë° ëª¨ë‹¬ UI
  - [ ] QR ì½”ë“œ ë‹¤ìš´ë¡œë“œ/ì¸ì‡„ ê¸°ëŠ¥
  - [ ] í•™ìƒìš© QR ìŠ¤ìº” ìë™ ì°¸ì—¬
- [ ] **êµì‚¬ë³„ Gemini API í‚¤ ê´€ë¦¬**
  - [ ] ì•”í˜¸í™”ëœ API í‚¤ ì €ì¥ ì‹œìŠ¤í…œ
  - [ ] API í‚¤ ìœ íš¨ì„± ê²€ì¦
  - [ ] ì‚¬ìš©ëŸ‰ ì¶”ì  ë° ë¹„ìš© ê´€ë¦¬
- [ ] **í´ë˜ìŠ¤/í™œë™ ì •ë³´ ìˆ˜ì • ê¸°ëŠ¥ êµ¬í˜„**
- [ ] **í™œë™ íˆìŠ¤í† ë¦¬ ì €ì¥ ë° ì¡°íšŒ ì‹œìŠ¤í…œ**  
- [ ] **AI í”¼ë“œë°± ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ê°œì„ **
  - [ ] onSnapshot ë¦¬ìŠ¤ë„ˆë¥¼ í†µí•œ ì‹¤ì‹œê°„ ê°ì§€
  - [ ] 30ì´ˆ íƒ€ì„ì•„ì›ƒ ë° ì—ëŸ¬ ì²˜ë¦¬
  - [ ] ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€ë¥¼ ìœ„í•œ ë¦¬ìŠ¤ë„ˆ ì •ë¦¬
- [ ] **ë¡œë”© ìƒíƒœ ë° ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ **
- [ ] **ë°˜ì‘í˜• UI ë²„ê·¸ ìˆ˜ì •**

### âœ… **2ë‹¨ê³„ ì™„ë£Œ ì¡°ê±´ (5-7ì£¼)**

- [ ] **ë‚±ë§ íƒí—˜ ëª¨ë‹¬ UI ì™„ì„±**
- [ ] **ì™¸ë¶€ ì‚¬ì „ API ì—°ë™ (ë˜ëŠ” AI ê¸°ë°˜ ì–´íœ˜ í™•ì¥)**
- [ ] **ê°œì¸ ë‚±ë§ ê¿€ëŸ¬ë¯¸ ì‹œìŠ¤í…œ**
- [ ] **í¬ì¸íŠ¸/ë ˆë²¨/ë°°ì§€ ì‹œìŠ¤í…œ**
- [ ] **í•™ìƒ í¬íŠ¸í´ë¦¬ì˜¤ í˜ì´ì§€**

### âœ… **3ë‹¨ê³„ ì™„ë£Œ ì¡°ê±´ (6-8ì£¼)**
- [ ] ê°œì¸í™” AI íŠœí„° ì‹œìŠ¤í…œ
- [ ] ì ì‘í˜• ë‚œì´ë„ ì¡°ì ˆ
- [ ] í•™ìŠµ íŒ¨í„´ ë¶„ì„ ì•Œê³ ë¦¬ì¦˜
- [ ] ê°œì¸í™”ëœ í™œë™ ì¶”ì²œ

---

## ğŸ¯ **ì„±ê³µ ì§€í‘œ ë° ê²€ì¦ ë°©ë²•**

### ğŸ“Š **ì •ëŸ‰ì  ì§€í‘œ**
- **ì‚¬ìš©ì ì°¸ì—¬ë„**: ì„¸ì…˜ë‹¹ í‰ê·  í™œë™ ì‹œê°„ 20ë¶„ ì´ìƒ
- **í•™ìŠµ íš¨ê³¼**: í•™ìƒë‹¹ í‰ê·  ì‹ ê·œ ì–´íœ˜ íšë“ 5ê°œ ì´ìƒ/ìˆ˜ì—…
- **ì¬ì‚¬ìš©ë¥ **: êµì‚¬ì˜ 70% ì´ìƒì´ ë™ì¼ ë„êµ¬ ì¬ì‚¬ìš©
- **ì™„ì„±ë¥ **: í™œë™ ì™„ì„±ë¥  85% ì´ìƒ


### ğŸ“ **ì •ì„±ì  ì§€í‘œ**
- **êµì‚¬ ë§Œì¡±ë„**: ì„¤ë¬¸ì¡°ì‚¬ í‰ê·  4.0/5.0 ì´ìƒ

- **í•™ìŠµ ë™ê¸°**: ê¸€ì“°ê¸°ì— ëŒ€í•œ ê¸ì •ì  ì¸ì‹ ë³€í™”
- **ì‚¬ìš©ì í”¼ë“œë°±**: ì¶”ê°€ëœ ê¸°ëŠ¥ ì¤‘ í™œìš©ë„ ìˆœìœ„ íŒŒì•…

### ğŸ” **A/B í…ŒìŠ¤íŠ¸ ê³„íš**
- **Google ë¡œê·¸ì¸ vs ìµëª… ë¡œê·¸ì¸**: ì‚¬ìš©ì í¬íŠ¸í´ë¦¬ì˜¤ í™œìš©ë„ ë¹„êµ

- **ë‚±ë§ íƒí—˜ vs ê¸°ì¡´ ë°©ì‹**: ì–´íœ˜ í•™ìŠµ íš¨ê³¼ ë¹„êµ

- **ê²Œì„í™” ìš”ì†Œ**: í¬ì¸íŠ¸ ì‹œìŠ¤í…œì´ ë™ê¸°ë¶€ì—¬ì— ë¯¸ì¹˜ëŠ” ì˜í–¥

## ì¶”ê°€ ê°œì„  ê³„íš ìš”ì•½

ì´ ë¬¸ì„œì—ì„œëŠ” ê¸°ì¡´ ì•±ì˜ ì‚¬ìš©ì„±ê³¼ ê¸°ëŠ¥ì„ í¬ê²Œ í–¥ìƒì‹œí‚¬ ì„¸ ê°€ì§€ í•µì‹¬ ê°œì„ ì‚¬í•­ì„ ìƒˆë¡­ê²Œ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤:

1. **Google ë¡œê·¸ì¸ ë° í•™ìƒ í¬íŠ¸í´ë¦¬ì˜¤ ì—°ê³„**
   - í•™ìƒë“¤ì´ ìµëª… ë° Google ê³„ì • ì¤‘ ì„ íƒí•˜ì—¬ ì°¸ì—¬í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„
   - Google ë¡œê·¸ì¸ ì‚¬ìš© ì‹œ ê°œì¸ í•™ìŠµ ê¸°ë¡ ìœ ì§€ ë° í•™ìŠµ í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì¶• ê°€ëŠ¥

2. **QR ì½”ë“œ í´ë˜ìŠ¤ ì°¸ì—¬ ì‹œìŠ¤í…œ**
   - êµì‚¬ê°€ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œ í›„ QR ì½”ë“œë¥¼ ìƒì„±í•˜ì—¬ ìƒíŒŒ
   - í•™ìƒë“¤ì´ QR ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ì—¬ ê°„í¸í•˜ê²Œ í´ë˜ìŠ¤ì— ì°¸ì—¬í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥

3. **êµì‚¬ë³„ Gemini API í‚¤ ê´€ë¦¬**
   - ê° êµì‚¬ê°€ ìì‹ ì˜ API í‚¤ë¥¼ ì…ë ¥í•˜ì—¬ ì‚¬ìš©ëŸ‰ì„ ì§ì ‘ ê´€ë¦¬
   - í”¼ë“œë°± ìƒì„± ì‚¬ìš©ëŸ‰ ì„ íƒì  ì¡°ì ˆ ê°€ëŠ¥

ì´ ìƒì„¸í•œ ê°œë°œ ê³„íšì„ í†µí•´ ê¸°ì¡´ ì•±ì˜ ì¥ì ì„ ìœ ì§€í•˜ë©´ì„œë„ ê°œë°œ ê³„íš ë¬¸ì„œì˜ ë¹„ì „ì„ ë‹¨ê³„ì ìœ¼ë¡œ ì‹¤í˜„í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ê° ë‹¨ê³„ë³„ë¡œ ëª…í™•í•œ ëª©í‘œì™€ ì„±ê³µ ì§€í‘œë¥¼ ì„¤ì •í•˜ì—¬ ì²´ê³„ì ì¸ ê°œë°œì´ ê°€ëŠ¥í•˜ë„ë¡ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.
